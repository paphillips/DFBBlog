---
layout:        default
title:         Moving (Gliding) Average, Recursive Implementation

categories:    [Examples - filter kernels]
image:         /assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-thumb.png
summary:       Example of a moving average filter on the input signal using a recursive algorithm, non-symmetric (one-side averaging), for fast execution. 'Recursive' in this context means the result of one calculation is used in a future calculation.M + 4 cycle delay from first sample to first output. 6 cycle delay thereafter.
author:        Paul Phillips

level:         medium
date:          2018-04-01

---
<div id="contentcontainer">
  <h1>Moving (Gliding) Average, Recursive Implementation
</h1>
  <p>Example of a moving average filter on the input signal using a recursive algorithm, non-symmetric (one-side averaging), for fast execution. 'Recursive' in this context means the result of one calculation is used in a future calculation.M + 4 cycle delay from first sample to first output. 6 cycle delay thereafter.</p>
  <table class="table table-sm" style="width: 75 %;">
    <tr>
      <td>Author</td>
      <td>Paul Phillips
</td>
    </tr>
    <tr>
      <td>Date</td>
      <td>2018-04-01
</td>
    </tr>
    <tr>
      <td>Date</td>
      <td>
        <span class="badge badge-warning" />medium</td>
    </tr>
    <tr>
      <td>Basic Equation</td>
      <td>\( \Large y[i] = y[i - 1] + x[i] - x[i - M] \over M \)
</td>
    </tr>
    <tr>
      <td></td>
      <td>x: input sample
</td>
    </tr>
    <tr>
      <td></td>
      <td>y: output moving average result
</td>
    </tr>
    <tr>
      <td></td>
      <td>i: current sample
</td>
    </tr>
    <tr>
      <td></td>
      <td>M: # of samples in the moving average window</td>
    </tr>
    <tr>
      <td>Strategy</td>
      <td>Moving average calculation is reduced to two multiple-accumulates and one addition.
This strategy divides each term by M at each instruction via multiply, rather than
waiting until the end, and re-orders y[i - 1] to the end:
</td>
    </tr>
    <tr>
      <td>Realized Equation</td>
      <td>\( \Large y[i] = \frac{x[i]}{M} + \frac{x[i - M]}{-M} + \frac{y[i - 1]}{M} \)
</td>
    </tr>
    <tr>
      <td></td>
      <td>\( x[i] * 1/M \quad \) Multiply-accumulate.  1/M is pre-calculated. x[i] = current input
</td>
    </tr>
    <tr>
      <td></td>
      <td>\( x[i - M] * -1/M \quad \) Multiply-accumulate. -1/M is pre-calculated. x[i - M] = last sample before current moving average window
</td>
    </tr>
    <tr>
      <td></td>
      <td>\( y[i - 1] \quad \) ALU addition with MACC result from above two steps</td>
    </tr>
    <tr>
      <td>Assumptions</td>
      <td>After inputs start, input samples and moving average calculation will be continuous and will not reset</td>
    </tr>
  </table>
  <a href="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive.dfbproj" class="btn btn-success btn-lg active" role="button">Download this project</a>
  <h2>Program Listing </h2>
  <pre id="code" class="language-asmcypressdfb line-numbers show" data-start="26">
    <code>
initialize:
    // [brief]  Initialization

    // [acu].a    Load lower wraparound address
    // [acu].b    Set address to start of coefficient data (0x00)
    acu(loadl, clear) addr(0) dmux(sa, sa) alu(hold) mac(hold)

    // [acu]    Load upper wraparound address
    acu(loadm, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) jmp(eob, wait_for_input)

wait_for_input:
    // [brief]  Wait state for input data availability
    
    // Conditional jump: STAGE_A input available?
    // [true]   Go to [moving_avg_init]
    // [false]  Loop
    acu(clear, clear) dmux(sa, sa) alu(hold) mac(hold) jmpl(in1, moving_avg_init)

moving_avg_init:
    // [brief]  The first M averages are invalid. This populates the calculation data but does not output the average until valid values are possible.
    // Since we need M+1 samples in DataRam_A memory for the calculation (M, plus x[i-M]) and rely on modulus acu wraparound to discard the first M samples' invalid moving average results,
    //  we actually have a delay penalty of M+1 samples (the first valid moving average from the input stream is lost)
    
    // [acu].b  Reset position to coefficient start
    // [dmux].a Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer
    acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)

    // [dmux].a Pipeline prep to read stored input x[i] from DataRam_A to [mac].a
    // [dmux].b Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b
    // [mac]    Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)
    // [write]  Write the incoming sample to DataRam A circular buffer
    acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)

    // [acu].a  Advance to next position, which represents the first stored input from the avg window x[i - M]
    // [acu].b  Advance to the next coefficient
    // [dmux].a Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a
    // [dmux].b Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b
    // [mac]    Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)
    acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)

    // [acu].b  Advance to y[i - 1] position
    // [dmux].a Pipeline prep to connect MAC calculation output to ALU 'add' input side a
    // [dmux].b Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b
    // [mac]    Multiply and accumulate (x[i - M] * -1/M)
    acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)

    // Pipeline delay waiting for ALU 'add' output
    acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)

    // [write]  Write the moving average result to DataRam_B
    acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db) jmpl(acuaeq, moving_avg_loop)

moving_avg_loop:
    // [brief]  Calculate moving average

    // [acu].b  Reset position to coefficient start
    // [dmux].a Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer
    acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)

    // [dmux].a Pipeline prep to read stored input x[i] from DataRam_A to [mac].a
    // [dmux].b Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b
    // [mac]    Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)
    // [write]  Write the incoming sample to DataRam A circular buffer
    acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)

    // [acu].a  Advance to next position, which represents the first stored input from the avg window x[i - M]
    // [acu].b  Advance to the next coefficient
    // [dmux].a Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a
    // [dmux].b Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b
    // [mac]    Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)
    acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc) 

    // [acu].b  Advance to y[i - 1] position
    // [dmux].a Pipeline prep to connect MAC calculation output to ALU 'add' input side a
    // [dmux].b Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b
    // [mac]    Multiply and accumulate (x[i - M] * -1/M)
    acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)

    // Pipeline delay waiting for ALU 'add' output
    acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)

    // [write]  Write the moving average result to DataRam_B y[i - 1] and to the output
    acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db, abus) jmpl(eob, moving_avg_loop)

area acu
org 0
dw 0x0000   // [CFG_X_LREG]       Dataram address beg of M-sample circular buffer, fixed at 0x00 | 
dw 0x0500   // [CFG_X_MREG]       Dataram address end of M-sample circular buffer, set this to M + 1 | 

// These are added to aid debugging - data_a doesn't need to be defined
area data_a
org 0
dw 0x000000 // [CAL_SAMP_BUF_0]     Sample circular (ring) buffer
dw 0x000000 // [CAL_SAMP_BUF_1]     Sample circular (ring) buffer
dw 0x000000 // [CAL_SAMP_BUF_2]     Sample circular (ring) buffer
dw 0x000000 // [CAL_SAMP_BUF_3]     Sample circular (ring) buffer
dw 0x000000 // [CAL_SAMP_BUF_4]     Sample circular (ring) buffer
dw 0x000000 // [CAL_SAMP_BUF_5]     Sample circular (ring) buffer

// These multiplier coefficients are arranged in order of use, so that we may simply issue acu command 'incr' after each step
area data_b
org 0
dw 0x19999A // [CFG_DENOM_MULT_POS] denominator: +1/M. This example uses M of 5: = +1/5 = +0.2
dw 0xE66666 // [CFG_DENOM_MULT_NEG] denominator: -1/M. This example uses M of 5: = -1/5 = -0.2
dw 0x000000 // [CAL_Y_LAST] The last moving average value calculated, y[i - 1]
</code>
  </pre>
  <p style="page-break-after: always;" />
  <h2>State Diagrams</h2>
  <figure class="figure figure-xl">
    <div id="carousel" class="carousel slide" data-interval="false">
      <ol class="carousel-indicators carousel-indicators-numbers">
        <li data-target="#carousel" data-slide-to="0" class="active">0</li>
        <li data-target="#carousel" data-slide-to="1">1</li>
        <li data-target="#carousel" data-slide-to="2">2</li>
        <li data-target="#carousel" data-slide-to="3">3</li>
        <li data-target="#carousel" data-slide-to="4">4</li>
        <li data-target="#carousel" data-slide-to="5">5</li>
        <li data-target="#carousel" data-slide-to="6">6</li>
        <li data-target="#carousel" data-slide-to="7">7</li>
        <li data-target="#carousel" data-slide-to="8">8</li>
        <li data-target="#carousel" data-slide-to="9">9</li>
        <li data-target="#carousel" data-slide-to="10">10</li>
        <li data-target="#carousel" data-slide-to="11">11</li>
        <li data-target="#carousel" data-slide-to="12">12</li>
        <li data-target="#carousel" data-slide-to="13">13</li>
        <li data-target="#carousel" data-slide-to="14">14</li>
        <li data-target="#carousel" data-slide-to="15">15</li>
        <li data-target="#carousel" data-slide-to="16">16</li>
        <li data-target="#carousel" data-slide-to="17">17</li>
        <li data-target="#carousel" data-slide-to="18">18</li>
        <li data-target="#carousel" data-slide-to="19">19</li>
        <li data-target="#carousel" data-slide-to="20">20</li>
        <li data-target="#carousel" data-slide-to="21">21</li>
        <li data-target="#carousel" data-slide-to="22">22</li>
        <li data-target="#carousel" data-slide-to="23">23</li>
        <li data-target="#carousel" data-slide-to="24">24</li>
        <li data-target="#carousel" data-slide-to="25">25</li>
        <li data-target="#carousel" data-slide-to="26">26</li>
        <li data-target="#carousel" data-slide-to="27">27</li>
        <li data-target="#carousel" data-slide-to="28">28</li>
        <li data-target="#carousel" data-slide-to="29">29</li>
        <li data-target="#carousel" data-slide-to="30">30</li>
        <li data-target="#carousel" data-slide-to="31">31</li>
        <li data-target="#carousel" data-slide-to="32">32</li>
        <li data-target="#carousel" data-slide-to="33">33</li>
        <li data-target="#carousel" data-slide-to="34">34</li>
        <li data-target="#carousel" data-slide-to="35">35</li>
        <li data-target="#carousel" data-slide-to="36">36</li>
        <li data-target="#carousel" data-slide-to="37">37</li>
        <li data-target="#carousel" data-slide-to="38">38</li>
        <li data-target="#carousel" data-slide-to="39">39</li>
        <li data-target="#carousel" data-slide-to="40">40</li>
        <li data-target="#carousel" data-slide-to="41">41</li>
        <li data-target="#carousel" data-slide-to="42">42</li>
        <li data-target="#carousel" data-slide-to="43">43</li>
        <li data-target="#carousel" data-slide-to="44">44</li>
        <li data-target="#carousel" data-slide-to="45">45</li>
        <li data-target="#carousel" data-slide-to="46">46</li>
        <li data-target="#carousel" data-slide-to="47">47</li>
        <li data-target="#carousel" data-slide-to="48">48</li>
        <li data-target="#carousel" data-slide-to="49">49</li>
      </ol>
      <div class="carousel-inner">
        <div class="carousel-item active" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle0.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 0</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> initialize</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="32">
                <code>acu(loadl, clear) addr(0) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">loadl</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loads lreg from ACU RAM, puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Load lower wraparound address</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Set address to start of coefficient data (0x00)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">0</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>ACU A address 0 selected</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle1.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 1</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> initialize</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="35">
                <code>acu(loadm, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) jmp(eob, wait_for_input)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">loadm</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loads mreg from ACU RAM, puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>ACU A address 1 selected</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmp</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Similar to goto. Conditions are true: jump to the target routine. Conditions are false: fall through to next state numerically.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">eob</span>
                      <span> End Of Block. A condition for a jump, which is always met because a jump instruction signifies the end of the block.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">Always:</span>
                      <span> go to wait_for_input</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle2.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 2</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> wait_for_input</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="43">
                <code>acu(clear, clear) dmux(sa, sa) alu(hold) mac(hold) jmpl(in1, moving_avg_init)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">in1</span>
                      <span> Input Register 1 (Stage A) Value Ready signal. When it is asserted, a new input cycle is available for consumption.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">Always:</span>
                      <span> go to moving_avg_init</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle3.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 3</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="52">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle4.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 4</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="58">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle5.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 5</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="65">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle6.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 6</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="71">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle7.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 7</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="74">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle8.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 8</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="77">
                <code>acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db) jmpl(acuaeq, moving_avg_loop)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">db</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam B selected for write</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">acuaeq</span>
                      <span> ACU A Equals. Asserted when ACU A detects a wraparound condition: If modulus arithmetic is disabled - zero or maximum data RAM location, else the max and min modulo counter limit.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">Always:</span>
                      <span> go to moving_avg_loop</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle9.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 9</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="52">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle10.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 10</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="58">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle11.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 11</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="65">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle12.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 12</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="71">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle13.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 13</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="74">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle14.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 14</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="77">
                <code>acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db) jmpl(acuaeq, moving_avg_loop)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">db</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam B selected for write</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">acuaeq</span>
                      <span> ACU A Equals. Asserted when ACU A detects a wraparound condition: If modulus arithmetic is disabled - zero or maximum data RAM location, else the max and min modulo counter limit.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">Always:</span>
                      <span> go to moving_avg_loop</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle15.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 15</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="52">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle16.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 16</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="58">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle17.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 17</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="65">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle18.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 18</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="71">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle19.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 19</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="74">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle20.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 20</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="77">
                <code>acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db) jmpl(acuaeq, moving_avg_loop)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">db</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam B selected for write</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">acuaeq</span>
                      <span> ACU A Equals. Asserted when ACU A detects a wraparound condition: If modulus arithmetic is disabled - zero or maximum data RAM location, else the max and min modulo counter limit.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">Always:</span>
                      <span> go to moving_avg_loop</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle21.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 21</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="52">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle22.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 22</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="58">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle23.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 23</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="65">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle24.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 24</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="71">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle25.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 25</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="74">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle26.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 26</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="77">
                <code>acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db) jmpl(acuaeq, moving_avg_loop)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">db</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam B selected for write</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">acuaeq</span>
                      <span> ACU A Equals. Asserted when ACU A detects a wraparound condition: If modulus arithmetic is disabled - zero or maximum data RAM location, else the max and min modulo counter limit.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">Always:</span>
                      <span> go to moving_avg_loop</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle27.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 27</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="52">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle28.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 28</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="58">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle29.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 29</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="65">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle30.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 30</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="71">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle31.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 31</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="74">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle32.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 32</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_init</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="77">
                <code>acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db) jmpl(acuaeq, moving_avg_loop)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">db</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam B selected for write</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">acuaeq</span>
                      <span> ACU A Equals. Asserted when ACU A detects a wraparound condition: If modulus arithmetic is disabled - zero or maximum data RAM location, else the max and min modulo counter limit.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">Always:</span>
                      <span> go to moving_avg_loop</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle33.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 33</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="84">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle34.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 34</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="90">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle35.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 35</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="97">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle36.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 36</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="103">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle37.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 37</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="106">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle38.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 38</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="109">
                <code>acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db, abus) jmpl(eob, moving_avg_loop)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">db</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam B selected for write</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">abus</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Hold A (out 1) selected for write from addr(1)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">eob</span>
                      <span> End Of Block. A condition for a jump, which is always met because a jump instruction signifies the end of the block.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="0">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="0"></td>
                    <td rowspan="0"></td>
                    <td rowspan="0"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle39.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 39</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="84">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle40.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 40</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="90">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle41.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 41</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="97">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle42.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 42</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="103">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle43.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 43</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="106">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle44.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 44</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="109">
                <code>acu(hold, hold) addr(1) dmux(sa, sa) alu(hold) mac(hold) write(db, abus) jmpl(eob, moving_avg_loop)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">db</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam B selected for write</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">abus</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Hold A (out 1) selected for write from addr(1)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">jmp</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">jmpl</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Loop. Conditions are true: jump to the target routine. Conditions are false: loop back to the start of the current code block.</td>
                  </tr>
                  <tr>
                    <td rowspan="1">
                      <span class="badge badge-primary">Jump Conditions</span>
                    </td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td rowspan="1"></td>
                    <td>
                      <span class="badge badge-dark">eob</span>
                      <span> End Of Block. A condition for a jump, which is always met because a jump instruction signifies the end of the block.</span>
                    </td>
                  </tr>
                  <tr>
                    <td rowspan="0">
                      <span class="badge badge-primary">Jump Branching</span>
                    </td>
                    <td rowspan="0"></td>
                    <td rowspan="0"></td>
                    <td rowspan="0"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle45.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 45</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="84">
                <code>acu(hold, clear) addr(1) dmux(brm, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">clear</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Sets reg to 0, put 0 on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Reset position to coefficient start</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">addr</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">1</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>In 1 (Stage A) selected for read</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">brm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Bus to RAM, to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read Stage_A input and write it to DataRam_A circular buffer</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle46.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 46</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="90">
                <code>acu(hold, hold) dmux(srm, srm) alu(hold) mac(clra) write(da)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read stored input x[i] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to read [CFG_DENOM_MULT_POS] (1 / M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">clra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Clears the accumulator. Loads it with the current product</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to clear the accumulator and multiply (x[i] * 1 / M)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">write</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">da</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>DataRam A selected for write</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle47.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 47</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="97">
                <code>acu(incr, incr) dmux(srm, srm) alu(hold) mac(macc)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to next position, which represents the first stored input from the avg window x[i - M]</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to the next coefficient</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load first stored input from the avg window x[i - M] from DataRam_A to [mac].a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to load [CFG_DENOM_MULT_NEG] (-1/M) from DataRam_B to [mac].b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">macc</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Multiply and accumulate with the previous values</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Loads input x[i] on side A, and the 1 / M coefficient on side B: (x[i] * 1 / M); pipeline prep to multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle48.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 48</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="103">
                <code>acu(hold, incr) dmux(srm, sra) alu(add) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">incr</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg + 1 on the output, writes to reg</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Advance to y[i - 1] position</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">srm</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM to MAC</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect MAC calculation output to ALU 'add' input side a</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-secondary">sra</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to RAM, RAM to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Pipeline prep to connect y[i - 1] value from DataRam_B to ALU 'add' input on side b</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">add</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Adds A and B and puts the result on the ALU output.</td>
                  </tr>
                  <tr>
                    <td rowspan="2">
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td rowspan="2" />
                    <td rowspan="2">
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td rowspan="2">
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-success">User comment</span> Multiply and accumulate (x[i - M] * -1/M)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="carousel-item" style="margin-top: 50px;">
          <div class="h-100">
            <object class="diagram-examples" type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-StateDiag-Cycle49.svg">Diagram can't be displayed: your browser does not support SVG</object>
          </div>
          <h3>Instruction for Cycle 49</h3>
          <hr />
          <p>
            <span class="badge badge-warning">Under label:</span> moving_avg_loop</p>
          <div>
            <div>
              <pre class="language-asmcypressdfb line-numbers" data-start="106">
                <code>acu(hold, hold) dmux(sa, sa) alu(hold) mac(hold)</code>
              </pre>
            </div>
            <div>
              <table class="table table-sm table-hover dfb">
                <thead>
                  <tr>
                    <th scope="col">Area</th>
                    <th scope="col">Bank</th>
                    <th scope="col">Instr</th>
                    <th scope="col">Delay</th>
                    <th scope="col">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">acu</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">hold</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">0</span>
                    </td>
                    <td>Puts reg on the output</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">A</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">dmux</span>
                    </td>
                    <td>
                      <span class="badge badge-primary">B</span>
                    </td>
                    <td>
                      <span class="badge badge-secondary">sa</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">1</span>
                    </td>
                    <td>Shifter to ALU</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">alu</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdalu</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the ALU output from the previous cycle.</td>
                  </tr>
                  <tr>
                    <td>
                      <span class="badge badge-primary">mac</span>
                    </td>
                    <td />
                    <td>
                      <span class="badge badge-secondary">holdmac</span>
                    </td>
                    <td>
                      <span class="badge badge-danger">2</span>
                    </td>
                    <td>Holds the accumulator, no multiply (no power in mult)</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" />
      </a>
      <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" />
      </a>
    </div>
  </figure>
  <p style="page-break-after: always;" />
  <h2>Jump Diagram</h2>
  <figure class="figure">
    <object type="image/svg+xml" data="/assets/posts/2018-04-03-kernel_moving_avg_recursive/2018-04-03-kernel_moving_avg_recursive-JumpDiagram.svg">Your browser does not support SVG</object>
    <figcaption class="figure-caption">Call Diagram for this program from the DFB Assembler Mini IDE</figcaption>
  </figure>
</div>